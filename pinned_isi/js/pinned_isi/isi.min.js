"use strict";var isi=function(t){var n,e,i,s,o,r,a,d,h,p,l,c,u,f,m,y,B,g,w,b,x,v,I,T,L,k,M,H={},D=!1,E={pinned:{top:"75%",position:"fixed"},expanded:{top:"8px",position:"absolute"},flow:{top:"",position:"static"}},S={pinned:{},expanded:{},flow:{}},N={pinned:{},expanded:{},flow:{}},q=document.createElement("div"),P=document.querySelector("body"),C=!1,R=document.getElementById("page-content"),O=(document.getElementById("indicator"),p=0),Y=!1,j="transform",A=325,W=function(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName},z=function(t){return"object"==typeof Node?t instanceof Node:t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},F=function(){ut.req.open("GET",ut.filePath,!0),ut.req.addEventListener("load",J),ut.req.send(null)},G=function(){for(var n in t.breakpoints)if(t.breakpoints[n].minWidth<=H.width&&t.breakpoints[n].maxWidth>=H.width)return t.breakpoints[n]},V=function(t){t?(ut.mobileInd&&(ut.mobileInd.style.display="block"),ut.mainInd&&(ut.mainInd.style.display="none")):(ut.mobileInd&&(ut.mobileInd.style.display="none"),ut.mainInd&&(ut.mainInd.style.display="block"))},X=function(t){V(t.mobileStacking),E.pinned=t.pinned.isi,S.pinned=t.pinned.customStyles,N.pinned=t.pinned.expandBtn,e=t.pinned.expandText,i=t.pinned.retractText,E.expanded=t.expanded.isi,S.expanded=t.expanded.customStyles,N.expanded=t.expanded.expandBtn,s=t.expanded.expandText,o=t.expanded.retractText,E.flow=t.flow.isi,S.flow=t.flow.customStyles,N.flow=t.flow.expandBtn,r=t.flow.expandText,a=t.flow.retractText,Z(),$()},J=function(){ut.wrapper.innerHTML=ut.isiMarkup=ut.req.response?ut.req.response:"<p>Please include the necessary markup within the isi.html.  Please note: this should be a document fragment.  Do not include doctype, head, or body tags.  All tags should be compatible for display within the body tag.  The html file extension is only used to ease syntax highlighting in most modern editors.</p>",M()},K=function(){var t=window,n="inner";return"innerWidth"in window||(n="client",t=document.documentElement||document.body),{width:t[n+"Width"],height:t[n+"Height"]}},Q=function(){var t,n=navigator.userAgent,e=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(e[1])?(t=/\brv[ :]+(\d+)/g.exec(n)||[],{name:"IE",version:t[1]||""}):"Chrome"===e[1]&&(t=n.match(/\bOPR\/(\d+)/),null!=t)?{name:"Opera",version:t[1]}:(e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=n.match(/version\/(\d+)/i))&&e.splice(1,1,t[1]),{name:e[0],version:e[1]})},U=function(){q.style.height=ut.position.height+"px",q.style.width=ut.position.width+"px",ut.parent.insertBefore(q,ut.wrapper)},Z=function(){d=E.pinned.top.indexOf("%")?.01*Number(E.pinned.top.slice(0,E.pinned.top.indexOf("%")))*H.height:Number(E.pinned.top.slice(0,E.pinned.top.indexOf("p")));for(var t in E[ut.state])ut.wrapper.style[t]=E[ut.state][t];for(var n in S[ut.state]){var e=document.querySelector(S[ut.state][n].selector);for(var i in S[ut.state][n].styles)e.style[i]=S[ut.state][n].styles[i]}},$=function(){for(var t in N[ut.state])ut.isiBtn.style[t]=N[ut.state][t],ut.indBtn.style[t]=N[ut.state][t];if(ut.isiBtn)switch(ut.state){case"pinned":ut.isiBtn.innerHTML=e;break;case"expanded":ut.isiBtn.innerHTML=s;break;case"flow":ut.isiBtn.innerHTML=r}if(ut.indBtn)switch(ut.state){case"pinned":ut.indBtn.innerHTML=e;break;case"expanded":ut.indBtn.innerHTML=s;break;case"flow":ut.indBtn.innerHTML=r}},_=function(){T&&clearTimeout(T),T=setTimeout(function(){ut.checkPos()},10)},tt=function(){L&&clearTimeout(L),L=setTimeout(function(){M(!0)},200)},nt=function(){M(!0)},et=function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY},it=function(t){O=t>l?l:p>t?p:t,R.style[j]="translateY("+-O+"px)",("flow"===ut.state||"expanded"===ut.state)&&(ut.wrapper.style[j]="translateY("+-O+"px)"),ut.checkPos()},st=function(t){if(t.target!==ut.isiBtn&&t.target!==ut.indBtn){if("a"===event.target.tagName.toLowerCase())return;return Y=!0,c=et(t),u=f=0,y=O,B=Date.now(),clearInterval(g),g=setInterval(ot,100),t.preventDefault(),t.stopPropagation(),!1}},ot=function(){w=Date.now(),b=w-B,B=w,v=O-y,y=O,I=1e3*v/(1+b),u=.8*I+.2*u},rt=function(t){return Y&&(x=et(t),v=c-x,(v>2||-2>v)&&(c=x,it(O+v))),t.preventDefault(),t.stopPropagation(),!1},at=function(t){return"a"!==event.target.tagName.toLowerCase()?(Y=!1,clearInterval(g),(u>10||-10>u)&&(f=.8*u,m=Math.round(O+f),B=Date.now(),requestAnimationFrame(dt)),t.preventDefault(),t.stopPropagation(),!1):void 0},dt=function ft(){f&&(b=Date.now()-B,v=-f*Math.exp(-b/A),v>.5||-.5>v?(it(m+v),requestAnimationFrame(ft)):it(m))},ht=function(){var t;return t=ut.position.top-H.height+(H.height-d)},pt=function(n){t[n]?ut[n]=W(t[n])||z(t[n])?t[n]:document.querySelector(t[n]):ut[n]=ut.createBtn(),ut[n+"HTML"]=ut[n].innerHTML,"isiBtn"===n&&(ut[n].onclick=ut.expandISI.bind(ut)),"indBtn"===n&&(ut[n].onclick=ut.expandIND.bind(ut)),ut[n+"Dim"]=ut[n].getBoundingClientRect()},lt=function(){ut.mobileInd=W(t.mobileIndication)||z(t.mobileIndication)?t.mobileIndication:document.querySelector(t.mobileIndication),ut.mainInd=W(t.mainIndication)||z(t.mainIndication)?t.mainIndication:document.querySelector(t.mainIndication)},ct=function(){ut.isiBtn&&(ut.isiBtn.style.display="none",$(),ut.isiBtn.innerHTML=o,ut.isiBtn.onclick=ut.retract.bind(ut),ut.isiBtn.ontouchstart=ut.retract.bind(ut)),ut.indBtn&&($(),ut.indBtn.innerHTML=o,ut.indBtn.onclick=ut.retract.bind(ut),ut.indBtn.ontouchstart=ut.retract.bind(ut)),ut.mobileInd&&(ut.mobileInd.style.height="auto",ut.mobileInd.style.borderBottom="none"),window.scrollTo(0,0)},M=function(n){h=(innerHeight-30)/l,n||(console.log(Q()),["webkit","Moz","O","ms"].every(function(t){var n=t+"Transform";return"undefined"!=typeof R.style[n]?(j=n,!1):!0}),"undefined"!=typeof window.ontouchstart&&(R.addEventListener("touchstart",st),R.addEventListener("touchmove",rt),R.addEventListener("touchend",at),ut.wrapper.addEventListener("touchstart",st),ut.wrapper.addEventListener("touchmove",rt),ut.wrapper.addEventListener("touchend",at),C=!0)),H=K(),lt(),X(G()),n||(ut.parent=ut.wrapper.parentNode,window.onscroll=_,window.onresize=tt,window.addEventListener("orientationchange",nt,!1),pt("isiBtn"),pt("indBtn")),n&&ut.unpin(),ut.position=ut.wrapper.getBoundingClientRect(),k=ht(),ut.checkPos(),t.callback.call()},ut={req:new XMLHttpRequest,initialPosition:{},isiMarkup:"",wrapper:W(t.wrapper)||z(t.wrapper)?t.wrapper:document.querySelector(t.wrapper),parent:{},mobileInd:null,mainInd:null,filePath:t.filePath?t.filePath:"isi.html",breakpoints:t.breakpoints?t.breakpoints:{all:{}},isiBtn:null,isiBtnHTML:null,isiBtnDim:{},indBtn:null,indBtnHTML:null,indBtnDim:{},state:"",prevState:"",checkPos:function(){if(l=parseInt(getComputedStyle(P).height,10)-innerHeight,this.position=this.wrapper.getBoundingClientRect(),D=C?this.position.top-H.height-O<H.height||"expanded"===this.state?!0:!1:this.position.top<H.height||"expanded"===this.state?!0:!1,!D)return void this.pin();if("expanded"!==this.state)if(q.parentElement)if(C){if(k>O)return;this.unpin()}else{if(n=q.getBoundingClientRect(),n.top>this.position.top)return;this.unpin()}else C?k>O?this.pin():"flow"!==this.state&&this.flow():this.position.top>d?this.pin():"flow"!==this.state&&this.flow()},createBtn:function(){var t=document.createElement("a");return t},expandISI:function(t){q.parentElement&&(this.state="expanded",this.parent.removeChild(q),Z(),C?(this.position=this.wrapper.getBoundingClientRect(),R.style.height=String(this.position.height)+"px",R.style.padding="0",R.style.border="none",R.style.overflow="hidden"):(R.style.height=E.expanded.top,R.style.overflow="hidden"),this.isiBtn&&this.indBtn?($(),this.isiBtn.innerHTML=o,this.indBtn.innerHTML=s,this.isiBtn.onclick=this.retract.bind(this),this.isiBtn.ontouchstart=this.retract.bind(this),this.indBtn.onclick=this.expandIND.bind(this),this.indBtn.ontouchstart=this.expandIND.bind(this)):this.isiBtn&&($(),this.isiBtn.innerHTML=o,this.isiBtn.onclick=this.retract.bind(this),this.isiBtn.ontouchstart=this.retract.bind(this)),window.scrollTo(0,0))},expandIND:function(t){q.parentElement?(this.state="expanded",this.parent.removeChild(q),Z(),ct(),C?(this.position=this.wrapper.getBoundingClientRect(),R.style.height=String(this.position.height)+"px",R.style.padding="0",R.style.border="none",R.style.overflow="hidden"):(R.style.height=E.expanded.top,R.style.overflow="hidden")):"expanded"===this.state&&(ct(),C&&(this.position=this.wrapper.getBoundingClientRect(),R.style.height=this.position.height,R.style.padding="0",R.style.border="none"))},retract:function(t){C?(R.style.height="",R.style.overflow="",R.style.padding="",R.style.border=""):(R.style.height="",R.style.overflow=""),this.isiBtn&&(this.isiBtn.style.display="block",$()),this.pin()},pin:function(){this.state="pinned",U(),Z(),this.wrapper.style[j]="translateY(0px)",this.isiBtn&&($(),this.isiBtn.innerHTML=e,this.isiBtn.onclick=this.expandISI.bind(this),this.isiBtn.ontouchstart=this.expandISI.bind(this)),this.indBtn&&($(),this.indBtn.innerHTML=e,this.indBtn.onclick=this.expandIND.bind(this),this.indBtn.ontouchstart=this.expandIND.bind(this)),this.mobileInd&&(this.mobileInd.style.height="")},unpin:function(){this.state="flow",this.parent.removeChild(q),Z(),this.wrapper.style[j]="translateY("+-O+"px)",this.isiBtn&&($(),this.isiBtn.innerHTML=a,this.isiBtn.style.height=this.isiBtnDim.height+"px",this.isiBtn.style.width=this.isiBtnDim.width+"px"),this.mobileInd&&(this.mobileInd.style.height="auto")},flow:function(){this.state="flow",Z(),this.isiBtn&&($(),this.isiBtn.innerHTML=r,this.isiBtn.style.height=this.isiBtnDim.height+"px",this.isiBtn.style.width=this.isiBtnDim.width+"px"),this.indBtn&&($(),this.indBtn.innerHTML=r,this.indBtn.style.height=this.indBtnDim.height+"px",this.indBtn.style.width=this.indBtnDim.width+"px")}};return F(),ut}(isiOptions);